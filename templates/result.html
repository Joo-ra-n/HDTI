<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>해달 MBTI 결과</title>
    <link rel="stylesheet" href="../static/css/base.css">
    <link rel="stylesheet" href="../static/css/loading.css">
    <link rel="stylesheet" href="../static/css/hdti.css">
    <link rel="stylesheet" href="../static/css/result.css">
    <link rel="stylesheet" href="../static/css/types.css">
    <link rel="stylesheet" href="../static/css/share.css">
    <meta property="og:type"               content="website" />
    <meta property="og:title"              content='{{ type_ex }}' />
    <meta property="og:description"        content='{{ explanation }}' />
    <meta property="og:url"                content=http://hdti.haedal.io/result?answersInput={{ type }} />
    <meta property="og:image"              content=http://hdti.haedal.io{{ img_og }} />

    <script src="https://drevelopes.kakao.com/sdk/js/kakao.js"></script>

</head>
<body>
    <div class="hdti-bg">
        <div class="charger-wrap">
        </div>
        <div class="result-wrap">
            <div class="result">
                <img class="result__character" src={{ img }} alt="캐릭터">
                <p class="result__title">{{ type_ex }}</p>
                <p class="result__content">{{ type }}</p>
            </div>
            <div class="result-detail" style="display: none;">
                <p class="result-detail__title">이 사람은...</p>
                <p class="result-detail__content">
                    {{ explanation }}
                </p>
            </div>
            <div class="result-option">
                <p id="resultOption1">1. 자세히보기</p>
                <p>2. 전체유형</p>
                <p>3. 다시하기</p>
                <p>4. 공유하기</p>
            </div>
        </div>
        <div id="haedalTypeTalk" class="haedal-type-talk">
            <img src="../static/img/type_desc.svg" alt="type">
        </div>
        <div class="btns">
            <img id="btn1" class="answer-btn1" src="../static/img/버튼_ok.svg" alt="버튼"><span id="btnText1" class="answer-btn1__text">1</span>
            <a href="../types"><img id="2" class="answer-btn2" src="../static/img/버튼_ok.svg" alt="버튼"><span class="answer-btn2__text">2</span></a>
            <a href="../hdti"><img id="3" class="answer-btn3" src="../static/img/버튼_ok.svg" alt="버튼"><span class="answer-btn3__text">3</span></a>
            <img id="btn4" class="answer-btn4" src="../static/img/버튼_ok.svg" alt="버튼"><span id="btnText4" class="answer-btn4__text">4</span>
            <img id="haedalCharacter" class="haedal-btn" src="../static/img/btn_haedal.svg" alt="버튼"></button>
        </div>
        <div class="share-btns" style="display: none;">
            <img id="twitterBtn"  class="share-btn up-btn"    onclick="window.open('https://twitter.com/intent/tweet?text=HDTI&url=http://hdti.haedal.io/result?answersInput={{ type }}','window_name','width=430,height=500,location=no,status=no,scrollbars=yes');" src="../static/img/트위터.svg" alt="버튼">
            <img id="facebookBtn" class="share-btn right-btn" onclick="window.open('http://www.facebook.com/sharer/sharer.php?u=http://hdti.haedal.io/result?answersInput={{ type }}','window_name','width=430,height=500,location=no,status=no,scrollbars=yes');"    src="../static/img/페이스북.svg" alt="버튼">
            <img id="urlBtn" class="share-btn down-btn" src="../static/img/url.svg" alt="버튼">
            <img id="kakaoBtn" class="share-btn left-btn" src="../static/img/카카오톡.svg" alt="버튼">
            <img id="okBtn" class="share-btn ok-btn" src="../static/img/버튼_ok.svg" alt="버튼">
            <img id="backBtn" class="share-btn back-btn" src="../static/img/버튼_왼쪽 화살표.svg" alt="버튼">
        </div>
        <input type="text" value='http://hdti.haedal.io/result?answersInput={{ type }}' id="urlAddress" style="display:none;">
    </div>
    <script>

    const btns = document.querySelector('.btns');
    const shareBtns = document.querySelector('.share-btns');
    const haedalTypeTalk = document.querySelector('#haedalTypeTalk');
    const haedalCharacter = document.querySelector('#haedalCharacter');
    const detailBtn = document.querySelector('#btn1');
    const btnText1 = document.querySelector('#btnText1');
    const shareBtn = document.querySelector('#btn4');
    const btnText4 = document.querySelector('#btnText4');
    const okBtn = document.querySelector('#okBtn');
    const backBtn = document.querySelector('#backBtn');
    const resultPage = document.querySelector('.result');
    const resultDetailPage = document.querySelector('.result-detail');
    const resultOptionPage = document.querySelector('.result-option');
    const resultOption1Btn = document.querySelector('#resultOption1');
    const resultOption4Btn = document.querySelector('#resultOption4');
    const kakaoBtn = document.querySelector('#kakaoBtn');
    const urlBtn = document.querySelector('#urlBtn');
    
    let isClicked = true;
    let isTypeClicked = false;

    detailBtn.addEventListener('click', function() {
        if(isClicked) {
            resultOption1Btn.innerText = '1.돌아가기';
            resultPage.style.display = 'none';
            resultDetailPage.style.display = 'block'; 
            isClicked = false;
        } else {
            resultOption1Btn.innerText = '1.자세히보기';
            resultPage.style.display = 'block';
            resultDetailPage.style.display = 'none'; 
            isClicked = true;
        }
        
    });

    btnText1.addEventListener('click', function() {
        if(isClicked) {
            resultOption1Btn.innerText = '1.돌아가기';
            resultPage.style.display = 'none';
            resultDetailPage.style.display = 'block'; 
            isClicked = false;
        } else {
            resultOption1Btn.innerText = '1.자세히보기';
            resultPage.style.display = 'block';
            resultDetailPage.style.display = 'none'; 
            isClicked = true;
        }
        
    });

    okBtn.addEventListener('click', function() {
        if(isClicked) {
            resultPage.style.display = 'none';
            resultDetailPage.style.display = 'block'; 
            isClicked = false;
        } else {
            resultPage.style.display = 'block';
            resultDetailPage.style.display = 'none'; 
            isClicked = true;
        }
        
    });

    haedalCharacter.addEventListener('click', function() {
        if(isTypeClicked) {
            haedalTypeTalk.style.display = 'none';
            isTypeClicked = false;
        } else {
            haedalTypeTalk.style.display = 'block';
            isTypeClicked = true;
        }
    });

    shareBtn.addEventListener('click', function() {
        resultOptionPage.style.display = 'none';
        btns.style.display = 'none';
        shareBtns.style.display = 'block';
    });

    btnText4.addEventListener('click', function() {
        resultOptionPage.style.display = 'none';
        btns.style.display = 'none';
        shareBtns.style.display = 'block';
    });

    backBtn.addEventListener('click', function() {
        resultOptionPage.style.display = 'flex';
        btns.style.display = 'block';
        shareBtns.style.display = 'none';
    });

    // 문항 수 표시
    const chargerBox = document.querySelector('.charger-wrap');
    
    for (let i=0; i<28; i++) {
        const charger = document.createElement('span');
        charger.classList.add('charger');
        chargerBox.appendChild(charger);
    }

    kakaoBtn.addEventListener('click', function() {
        // kakao 공유
        Kakao.init('c076ef382754c7143f26cec687f7d4d5');
        Kakao.Link.sendDefault({
            objectType: 'feed',
            content: {
                title: '해달 MBTI',
                description: '해달 개발자용 MBTI 검사입니다. 재미로 즐겨 주세요 :)',
                imageUrl: 'http://hdti.haedal.io/static/opengraph.png',
                link: {
                    webUrl: 'http://hdti.haedal.io',
                    mobileWebUrl: 'http://hdti.haedal.io',
                },
            },
        });
    });

    urlBtn.addEventListener('click', function() {
        const urlAddress = document.querySelector('#urlAddress');

        urlAddress.style.display = 'block';
        urlAddress.select();
        // safari
        urlAddress.setSelectionRange(0, 100);
        document.execCommand("Copy");
        urlAddress.style.display = 'none';
        alert('URL 주소가 복사 되었습니다');
    });
    </script>
</body>
</html>